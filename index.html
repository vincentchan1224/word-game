<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¤§é›»è¦– Big TV</title>
    <style>
        :root {
            --tv-orange: #ff9f43;
            --tv-case-dark: #d35400;
            --screen-bg: #111111;
            --btn-bingo: #2ecc71;
            --btn-pass: #e74c3c;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'PingFang HK', 'Heiti TC', sans-serif;
            background-color: #2c3e50;
            color: white;
            height: 100vh;
            overflow: hidden;
        }

        /* --- è¨­å®šä»‹é¢ --- */
        #setup-screen {
            position: fixed;
            inset: 0;
            background: #2c3e50;
            z-index: 100;
            display: flex;
            flex-direction: column;
            padding: 40px;
            overflow-y: auto;
        }

        h1 {
            font-size: 3.5rem;
            text-align: center;
            margin-bottom: 20px;
            color: var(--tv-orange);
            text-shadow: 3px 3px 0 #000;
        }

        .instructions {
            text-align: center;
            margin-bottom: 30px;
            color: #bdc3c7;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
            margin-bottom: 40px;
        }

        .cat-card {
            background: #34495e;
            padding: 25px 15px;
            border-radius: 20px;
            text-align: center;
            cursor: pointer;
            border: 4px solid transparent;
            font-size: 1.3rem;
            font-weight: bold;
            transition: all 0.2s;
        }

        .cat-card.selected {
            background: var(--tv-orange);
            border-color: #fff;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .config-box {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .btn-start {
            background: var(--btn-bingo);
            color: white;
            border: none;
            padding: 30px;
            border-radius: 25px;
            font-size: 2.5rem;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 10px 0 #27ae60;
        }

        .btn-start:active {
            transform: translateY(5px);
            box-shadow: 0 5px 0 #27ae60;
        }

        /* --- éŠæˆ²ä»‹é¢ --- */
        #game-screen {
            display: none;
            height: 100vh;
            flex-direction: column;
        }

        .stats-bar {
            height: 10vh;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 40px;
            font-size: 2.2rem;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.3);
        }

        /* å¡é€šé›»è¦– (75vh) */
        .tv-area {
            height: 75vh;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .tv-body {
            background: var(--tv-orange);
            width: 100%;
            max-width: 1000px;
            height: 95%;
            border-radius: 60px;
            border: 12px solid var(--tv-case-dark);
            display: flex;
            padding: 30px;
            position: relative;
            box-shadow: 0 20px 0 var(--tv-case-dark);
        }

        .tv-screen {
            flex: 5;
            background: var(--screen-bg);
            border-radius: 30px;
            border: 15px solid #222;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 0 80px #000;
        }

        #word-display {
            font-size: 10vw;
            font-weight: 900;
            color: #FFFFFF;
            text-align: center;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        .tv-knobs {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            align-items: center;
            padding-left: 20px;
        }

        .knob {
            width: 70px;
            height: 70px;
            background: #333;
            border-radius: 50%;
            border: 6px dashed #555;
        }

        .grill {
            width: 50px;
            height: 150px;
            background: repeating-linear-gradient(#333, #333 8px, transparent 8px, transparent 16px);
        }

        /* æŒ‰éˆ•å€ (15vh) */
        .controls {
            height: 15vh;
            display: flex;
        }

        .btn-action {
            border: none;
            font-size: 3.5rem;
            font-weight: 900;
            color: white;
            cursor: pointer;
        }

        .btn-pass {
            background: var(--btn-pass);
            width: 35%;
            border-top: 10px solid #c0392b;
        }

        .btn-bingo {
            background: var(--btn-bingo);
            width: 65%;
            border-top: 10px solid #219150;
        }

        .btn-action:active {
            opacity: 0.7;
        }
    </style>
</head>

<body>

    <div id="setup-screen">
        <h1>ğŸ“º å¤§é›»è¦–</h1>
        <p class="instructions">è«‹é»æ“Šé¸æ“‡ä¸€å€‹æˆ–å¤šå€‹åˆ†é¡é€²è¡ŒéŠæˆ²</p>

        <div class="category-grid" id="category-menu">
        </div>

        <div class="config-box">
            <span style="font-size: 1.5rem;">éŠæˆ²æ™‚é–“ï¼š</span>
            <input type="number" id="game-time" value="60"
                style="font-size: 1.5rem; padding: 10px; width: 100px; border-radius: 10px; border: none; text-align: center;">
            <span style="font-size: 1.5rem;">ç§’</span>
        </div>

        <button class="btn-start" onclick="startGame()">æ­£å¼é–‹æ³¢ï¼</button>
    </div>

    <div id="game-screen">
        <div class="stats-bar">
            <div>åˆ†æ•¸: <span id="score" style="color:var(--tv-orange)">0</span></div>
            <div id="timer">60s</div>
        </div>

        <div class="tv-area">
            <div class="tv-body">
                <div class="tv-screen">
                    <div id="word-display">æº–å‚™</div>
                </div>
                <div class="tv-knobs">
                    <div class="knob"></div>
                    <div class="knob"></div>
                    <div class="grill"></div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn-action btn-pass" onclick="handleAction(false)">PASS</button>
            <button class="btn-action btn-bingo" onclick="handleAction(true)">BINGO</button>
        </div>
    </div>

    <script>
        let gameData = {};
        let selectedCategories = new Set();
        let gameWords = [];
        let score = 0;
        let timeLeft = 0;
        let timerInterval;

        // --- è‡ªå‹•è®€å– JSON ä¸¦å»ºç«‹æŒ‰éˆ• ---
        fetch('data.json')
            .then(res => res.json())
            .then(data => {
                gameData = data;
                const menu = document.getElementById('category-menu');
                menu.innerHTML = ''; // æ¸…ç©ºåŠ è¼‰ä¸­æç¤º

                // ç²å– JSON å…§æ‰€æœ‰çš„åˆ†é¡åç¨± (Keys)
                const categories = Object.keys(gameData);

                categories.forEach(catName => {
                    const card = document.createElement('div');
                    card.className = 'cat-card';
                    card.innerText = catName;

                    // é»æ“Šé¸å–/å–æ¶ˆé¸å–é‚è¼¯
                    card.onclick = () => {
                        if (selectedCategories.has(catName)) {
                            selectedCategories.delete(catName);
                            card.classList.remove('selected');
                        } else {
                            selectedCategories.add(catName);
                            card.classList.add('selected');
                        }
                    };
                    menu.appendChild(card);
                });
            })
            .catch(err => {
                document.getElementById('category-menu').innerHTML = "<p style='color:red'>éŒ¯èª¤ï¼šç„¡æ³•è®€å– data.jsonã€‚è«‹ç¢ºä¿æª”æ¡ˆå·²ä¸Šå‚³è‡³ GitHubã€‚</p>";
            });

        function startGame() {
            if (selectedCategories.size === 0) {
                alert("è«‹å…ˆé¸æ“‡è‡³å°‘ä¸€å€‹åˆ†é¡ï¼");
                return;
            }

            // åˆä½µé¸ä¸­åˆ†é¡çš„æ‰€æœ‰å–®å­—
            gameWords = [];
            selectedCategories.forEach(cat => {
                gameWords = gameWords.concat(gameData[cat]);
            });

            // æ´—ç‰Œ (éš¨æ©Ÿæ’åº)
            gameWords.sort(() => Math.random() - 0.5);

            // é‡è¨­éŠæˆ²ç‹€æ…‹
            score = 0;
            timeLeft = parseInt(document.getElementById('game-time').value) || 60;
            document.getElementById('score').innerText = score;
            document.getElementById('timer').innerText = timeLeft + "s";

            // åˆ‡æ›ä»‹é¢
            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'flex';

            showNextWord();
            startTimer();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = timeLeft + "s";

                if (timeLeft <= 10) {
                    document.getElementById('timer').style.color = "#e74c3c";
                }

                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function showNextWord() {
            if (gameWords.length === 0) {
                endGame();
                return;
            }
            document.getElementById('word-display').innerText = gameWords[0];
        }

        function handleAction(isBingo) {
            if (isBingo) {
                score++;
                document.getElementById('score').innerText = score;
            }
            gameWords.shift(); // ç§»é™¤ç›®å‰çš„è©
            showNextWord();
        }

        function endGame() {
            clearInterval(timerInterval);
            alert("æ™‚é–“åˆ°ï¼\næœ€çµ‚åˆ†æ•¸ï¼š" + score);
            location.reload(); // é‡å•Ÿæ‡‰ç”¨
        }
    </script>
</body>

</html>